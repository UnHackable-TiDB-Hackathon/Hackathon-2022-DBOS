# TiOS - DBOS on TiDB

## UnHackable 团队

队长：
队员：王可，方钧源，赵海波

## 项目介绍

TiOS 旨在利用 TiDB 的分布式特性实现一个可扩容，易移植的操作系统，本项目结合 TiDB 文件存储的特性，希望实现一个基于 TiDB 的分布式文件系统，以 TiOS 的文件管理能力。

## 背景&动机

传统的分布式系统普遍采用分立节点实现，因此需要实现较为复杂文件管理和进程调度。

与此相比，TiOS 可以利用 TiDB 本身的分布式特性简化这些实现，并将数据库的可移植性转化为 TiOS 的可移植性。这样，依赖于一个较为简单的 DB Client 即可实现一个具有可无限扩容文件系统的操作系统。

## 项目设计

#### 文件系统实现思路

在文件系统的整体实现思路中，将文件系统内容按照大页进行存储，这种存储块可以被称为 “TiDisk”，对于每一个 TiDisk，将其再划分为相对小的 Chunk，用以存储单个文件内容，其大小选取在2倍平均文件大小，并通过一个对应的 TiDisk Describer 获取任一存储与当前 TiDisk 的文件的具体存储 Chunk，或 Chunk List。为了在系统中唯一的表示特定的文件，采用 TiDisk ID 结合 FileInDisk ID 的方式，综合生成一个全局唯一 ID。同时，用类 Linux 系统的树状层次文件目录表来对特定文件通过路径进行索引，获得其 TiDisk ID 以及FileInDisk ID，以辅助对持久存储空间的操作。

#### 应用加载方式

将单个 Lua 文件作为应用程序，由 Lua 引擎（如 Lupa, Luajit）执行。其中，实现一个文件系统服务（FileSys Service）将前文实现的依赖于 TiDB 的文件系统管理方式整理为 RPC 调用接口，注册到 Lua 引擎中供程序使用。
